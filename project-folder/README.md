# Class Project

## Install

**Tip:** There are `.env` or `.flaskenv` files present. Do "pip install python-dotenv" to use them.

- Run the below command lines

```
pip install python-dotenv
flask run
```

## Files

- Create a `config.py` to set Flask config variables with a `class Config:`
- Create a `.env` file containing
    - Database `SQLALCHEMY_DATABASE_URI = 'sqlite:///sitepreview.db'`
```
SECRET_KEY =
SQLALCHEMY_DATABASE_URI =
```
- `import_script.py` a separates py file to Create and Inserts json data into SQLAlchemy
- `app.py` executes the web application and creates the api class to render to the page

### Using UUID

Stores a **UUID** in the database natively when it can and falls back to a BINARY(16) or a CHAR(32) when it can't.

- [UUIDType from the SQLAlchemy-Utils package:](https://sqlalchemy-utils.readthedocs.io/en/latest/data_types.html#module-sqlalchemy_utils.types.uuid)
- [Source code for sqlalchemy_utils.types.uuid](https://sqlalchemy-utils.readthedocs.io/en/latest/_modules/sqlalchemy_utils/types/uuid.html#UUIDType)

```
from sqlalchemy_utils import UUIDType
import uuid

class User(Base):
    __tablename__ = 'user'

    # Pass `binary=False` to fallback to CHAR instead of BINARY
    id = sa.Column(UUIDType(binary=False), primary_key=True)
```

## Herokuapp

### Setup

**Install the Heroku CLI**
```
heroku login
```

**Clone the repository**
```
heroku git:clone -a python-web-scrapping
cd python-web-scrapping
```

**Deploy your changes**
```
git add .
git commit -am "make it better"
git push heroku master
```

- The application is now deployed. `heroku ps:scale web=1`
- Now visit the app at the URL generated by its app name. `heroku open`
    - View logs `heroku logs --tail`
- Create the file `requirements.txt`
    - Install directing to heroku `pip install -r requirements.txt`

```
beautifulsoup4==4.9.3
certifi==2020.12.5
chardet==3.0.4
click==7.1.2
Flask==1.1.2
Flask-Assets==2.0
Flask-SQLAlchemy==2.4.4
Flask-WTF==0.14.3
gunicorn==20.0.4
idna==2.10
itsdangerous==1.1.0
Jinja2==2.11.2
MarkupSafe==1.1.1
Pillow==8.0.1
python-dotenv==0.14.0
requests==2.25.0
soupsieve==2.0.1
SQLAlchemy==1.3.20
urllib3==1.26.2
webassets==2.0
Werkzeug==1.0.1
WTForms==2.3.3
```

**Define a Procfile - Microsoft Windows**

- Create files:
    - `Procfile` and add the code `web: gunicorn gettingstarted.wsgi --log-file -` 
    - `Procfile.windows` and add the code `web: python manage.py runserver 0.0.0.0:5000`

### Execute

View the [site](https://python-web-scrapping.herokuapp.com/) in action.

## SQLite3

Accessing `sitepreview.db` from terminal (command prompt)

- Open computer terminal
- `cd` to project directory
- In this project we define the database `'sqlite:///project_database.db'` config in `app.py`
    - Insert values to database by executing `py separate_import_file.py` 
- Return to teminal and type command `sqlite3 sitepreview.db`
    - `.tables` to display all tables in the database
    - `select * from previewDB;` to display all column and rows in the database
        - `select id from previewDB;` to view the column **id** pirmary key created using **UUID**

```
SQLite version 3.32.3 2020-06-18 14:00:33
Enter ".help" for usage hints.
sqlite> .tables
previewDB
sqlite> select * from previewDB;
sqlite> select id from previewDB;
```
- Use **Ctrl+C** to exit SQLite on Windows

Learned watching [Connecting to a SQLite Database Using Flask-SQLAlchemy](https://www.youtube.com/watch?v=KrRzZGcHjK8)
