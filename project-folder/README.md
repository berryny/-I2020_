# Class Project

## Install

**Tip:** There are `.env` or `.flaskenv` files present. Do "pip install python-dotenv" to use them.

- Run the below command lines

```
pip install python-dotenv
flask run
```

## Files

- Create a `config.py` to set Flask config variables with a `class Config:`
- Create a `.env` file containing
    - Database `SQLALCHEMY_DATABASE_URI = 'sqlite:///sitepreview.db'`
```
SECRET_KEY =
SQLALCHEMY_DATABASE_URI =
```
- `import_script.py` a separates py file to Create and Inserts json data into SQLAlchemy
- `app.py` executes the web application and creates the api class to render to the page

### Using UUID

Stores a **UUID** in the database natively when it can and falls back to a BINARY(16) or a CHAR(32) when it can't.

- [UUIDType from the SQLAlchemy-Utils package:](https://sqlalchemy-utils.readthedocs.io/en/latest/data_types.html#module-sqlalchemy_utils.types.uuid)
- [Source code for sqlalchemy_utils.types.uuid](https://sqlalchemy-utils.readthedocs.io/en/latest/_modules/sqlalchemy_utils/types/uuid.html#UUIDType)

```
from sqlalchemy_utils import UUIDType
import uuid

class User(Base):
    __tablename__ = 'user'

    # Pass `binary=False` to fallback to CHAR instead of BINARY
    id = sa.Column(UUIDType(binary=False), primary_key=True)
```

## Herokuapp

### Setup

**Install the Heroku CLI**
```
heroku login
```

**Clone the repository**
```
heroku git:clone -a python-web-scrapping
cd python-web-scrapping
```

**Deploy your changes**
```
git add .
git commit -am "make it better"
git push heroku master
```

- The application is now deployed. `heroku ps:scale web=1`
- Now visit the app at the URL generated by its app name. `heroku open`
    - View logs `heroku logs --tail`
- Create the file `requirements.txt`
    - Install directing to heroku `pip install -r requirements.txt`

```
beautifulsoup4==4.9.3
certifi==2020.12.5
chardet==3.0.4
click==7.1.2
Flask==1.1.2
Flask-Assets==2.0
Flask-SQLAlchemy==2.4.4
Flask-WTF==0.14.3
gunicorn==20.0.4
idna==2.10
itsdangerous==1.1.0
Jinja2==2.11.2
MarkupSafe==1.1.1
Pillow==8.0.1
python-dotenv==0.14.0
requests==2.25.0
soupsieve==2.0.1
SQLAlchemy==1.3.20
urllib3==1.26.2
webassets==2.0
Werkzeug==1.0.1
WTForms==2.3.3
```

**Define a Procfile - Microsoft Windows**

- Create files:
    - `Procfile` and add the code `web: gunicorn gettingstarted.wsgi --log-file -` 
    - `Procfile.windows` and add the code `web: python manage.py runserver 0.0.0.0:5000`

### Execute

View the [site](https://python-web-scrapping.herokuapp.com/) in action on Heroku.

## SQLite3

SQLite is a C-language library that implements a small, fast, self-contained, high-reliability, full-featured, SQL database engine. SQLite is the most used database engine in the world.

Accessing `project_database.db` from the terminal (command prompt)

- Open computer terminal
- `cd` to project directory
- In this project we define the database `'sqlite:///project_database.db'` config in `app.py`
    - Insert values to database by executing `py separate_import_file.py` 
- Return to teminal and type command `sqlite3 project_database.db`
    - `.tables` to display all tables in the database
    - `select * from tableDBName;` to display all column and rows in the database
        - `select id from tableDBName;` to view the column **id** pirmary key created using **UUID**

```
SQLite version 3.32.3 2020-06-18 14:00:33
Enter ".help" for usage hints.
sqlite> .tables
tableDBName
sqlite> select * from previewDB;
sqlite> select id from previewDB;
```
- Use **Ctrl+C** to exit SQLite on Windows

### SQLite3 Resources

- [What Is SQLite?](https://sqlite.org/index.html)
- [SQLite Python tutorial](http://zetcode.com/db/sqlitepythontutorial/)
- Learned watching youtube video [Connecting to a SQLite Database Using Flask-SQLAlchemy](https://www.youtube.com/watch?v=KrRzZGcHjK8)

## Project Deliverable

For your final project, you will need to:

- Scrape data of significance, clean it up to extract the specific data you need.
- Automate the process of storing it in your database.
- Create a flask application that will make our database accessible from the web and deploy it.

Setting up our flask web application and deploy it to a SAAS provider as opposed to setting up our own linux server and doing the devops ourselves.

The flask application will needs to:

- contain proper configs `(SECRET_KEY and SQLALCHEMY_DATABASE_URI)`.
- contain a database model that both your scraping script and the flask application uses.
- contain at least two routes (one providing an HTML response and the other a JSON response).
- your HTML response should be rendering a jinja template.

You should also try to do the following:

- customize your flask HTML views to display your data and to provide links to your API `(JSON views)`.
- demonstrate your understanding of the concepts we've discussed by integrating any of the things we covered.
- make your project portfolio worthy by cleaning up your code and making the views something you'd want to show a possible employer.
Once your flask application (and scraping script) runs without issue on your local machine, deploy your application to either Heroku or PythonAnywhere using the instructions from the lab section of our week 13 classes. As always, feel free to reach out to teaching staff via slack if help is needed.

When completed, submit the following:

- a link to your github repo
- a link to your live web application